# Smiley-Android-App

<hr>

<div align="center">
   <img src="https://raw.githubusercontent.com/Donghyeon0915/DataRepository/master/Smiley/smiley_cover.png" width="100%"/> &nbsp;&nbsp;
</div>

## 💡 주제

- 교정 자동화 & 관리 어플리케이션
- BLE + 압력 센서를 이용한 주걱턱 교정기, 교정기 케이스 착용 시간 측정

---

## 📝 설명

***Smiley***는 사용자의 **교정기 착용 여부** 및 **착용 시간**을 **실시간**으로 감지하여 교정 관리를 **자동화**하며, 

**착용 시간 관리, 일일 미션, 예약 관리, 챗봇 상담** 등 **교정에 관한 모든 편의기능을 앱에서 제공**합니다.

---

## ✨ 주요 기능

- **교정 장치 착용 시간 측정**
    - BLE 센서와 압력 센서를 통해 교정 장치 착용 여부 및 시간을 측정합니다.
    - 교정기 착용을 앱으로 관리할 수 있습니다.
- **안면 상태 측정**
    - 인공지능을 통해 안면 상태를 자세히 분석합니다.
    - 변화 과정을 한 눈에 볼 수 있어 동기부여를 극대화할 수 있습니다.
- **티어 & 뱃지 시스템**
    - 교정기 착용 시간, 일일 미션 달성 등 여러 활동으로 경험치와 뱃지를 획득할 수 있습니다.
    - 사용자가 더 이상 교정을 치료로 느끼지 않고 재미 요소로 느낄 수 있도록 하기 위한 기능입니다.
- **병원 예약 관리**
    - 병원 예약 관리 및 길 찾기 기능을 제공합니다.
    - 병원에 예약을 하고, 찾아가기 위해 다른 어플을 쓸 필요가 없습니다.
- **약품 성분 검사**
    - 치아 이동에 영향을 주는 약품을 판별합니다.
    - 의사의 상담을 받기 힘든 상황에서 급히 약을 복용 해야 할 때 유용한 기능입니다.
- **챗봇 상담 & FAQ**
    - 앱 내에서 교정에 관한 대부분의 정보를 얻을 수 있습니다.
    - 교정 중 궁금한 사항이 생겨도 병원 진료 날짜까지 기다리지 않아도 됩니다.

---

## 🫂 팀 협업 방식

- **Github Issue & Pull-Request** 관리를 통해 팀원 간의 업무 파악 및 진행 사항을 기록하고, 디자인, 프론트, 백엔드 파트들 간의 협업을 위해 **Figma, Swagger** 등의 툴을 사용하였습니다.
- **Github CI/CD**를 통해 통합 및 배포 환경을 자동화하였으며, 코딩 컨벤션을 맞추는 등의 방식으로 더 나은 코드를 작성할 수 있도록 노력하였습니다.

---

## 😀 새로 적용된 기술

### 1. Clean Architecture, Multi-Module

### 2. Github Actions를 통한 CI/CD

### 3. Coroutine-Flow

### 4. Hilt

### 5. StateFlow를 통한 UI 상태 관리

---

## 🤗 트러블 슈팅


> 💡 MVVM과 Clean Architecture를 결합한 구조 적용

- MVVM 패턴만 적용했을 때 앱이 복잡해질 수록 코드의 종속성이 높아지고, 코드의 역할을 분리하는 것이 점점 더 어려워지는 것을 경험했습니다.
- 이러한 문제점을 해결하기 위해 MVVM과 Clean Architecture, Multi Module을 통해 각 계층을 명확하게 분리하였습니다.
- 계층이 나눠지면서 코드의 분리가 확실히 이루어지고, 흐름을 쉽게 알 수 있게 되어 기능 추가에도 부담이 없는 구조로 만들 수 있게 되었습니다.


> 💡 내부 DB를 활용한 네트워크 요청 최적화

- 매일 12시에 당일 교정기 착용 시간을 서버로 전송하는 과정에서 서버로 트래픽이 집중되는 문제가 있었습니다.

- 당일 착용 시간은 날짜 별로 내부 DB에 저장해 둔 후, 사용자가 앱에 접속하는 시점에 전송 되지 않은 착용 데이터가 있는 경우에만 서버로 전송하도록 로직을 개선하였습니다.
- 최종적으로 트래픽이 분산 되어 서버가 대용량 트래픽에도 대비할 수 있게 되었습니다.


> 💡 검색 시 서버 부하를 고려한 캐시 전략 (평균 응답 시간 2,000ms → 200ms)

- 해당 앱은 의약품 및 전국 병원 정보를 공공 데이터 포탈로부터 받아오고 있으며, 검색 화면에서 초기 데이터를 불러오는 데 약 2초의 시간이 걸릴 정도로 데이터의 양이 많았습니다.
- 해당 데이터를 여러 사용자가 동시에 요청할 경우 서버에 큰 부담이 가해질 수 있는 상황이었습니다.
- 서버의 부담을 줄이고 사용자에게 최적의 환경을 제공할 수 있도록 Retrofit을 통해 데이터를 캐싱하는 방법을 선택 하였습니다.
- 의약품 및 병원 데이터 특성 상 자주 변하는 데이터가 아니기 때문에 캐시 데이터의 expire time을 길게 주었습니다. 결과적으로, 검색을 위한 초기 데이터 로딩 시 평균 응답 시간이 약 2,000ms에서 200ms까지 대폭 감소하였습니다.


> 💡 GPS, GIS 정보를 이용한 병원 지도 개발

- 주변의 치과를 조회하고, 사용자가 등록한 치과까지 가는 길을 계산해주는 기능을 개발한 경험이 있습니다. 해당 기능에선 사용자가 일정 반경 이상을 이동했거나, 스와이프를 통해 지도를 움직였을 때 지도의 중심 좌표를 기준으로 주변 치과를 갱신 해야 했습니다.

- 특히, 사용자의 위치가 실시간으로 변경되고, 이에 따라 위치 데이터를 기반으로 주변 치과의 데이터를 실시간으로 갱신해야 했기에, 앱의 화면을 끊김 없이 유지하면서 백그라운드에서 빠르게 작업을 처리하는 것이 가장 중요했습니다.
- 이를 위해 Coroutine과 Flow를 사용하여 비동기 방식으로 빠르게 데이터를 처리하여 사용자에게 더욱 부드러운 앱을 제공할 수  있었습니다.


> 💡 StateFlow를 통한 Ui State 관리

- 해당 프로젝트는 저전력 블루투스를 통해 교정 장치와 연결합니다. 이 과정에서 검색, 결과 출력, 장치 연결, 검색 취소, 연결 취소 등 한 화면에서 많은 상호작용이 일어나는 경우가 잦았습니다.
- 특히, 한 화면에 여러 동작이 개별적인 동작이 아니라 현재 어떤 작업을 하고 있는 지에 따라 다르게 처리되어야 했기에 자칫 잘못하면 코드가 매우 복잡해질 수 있는 상황이었습니다.

- 이를 해결하기 위해 StateFlow와 State 패턴을 통해 UI의 상태를 구분한 뒤, 각 상태에서의 행동을 지정해주는 방식으로 복잡한 상태를 쉽게 풀어낼 수 있었습니다.
- 이처럼, 위와 같은 경험을 통해 실시간 데이터 처리, 트래픽 분산, 하드웨어 센서와 안드로이드 앱 연동, 데이터 분석과 다양한 그래프로 데이터를 표현하는 등 여러 경험을 통해 개발자로서의 역량을 다방면으로 쌓을 수 있었습니다.

## 📘 ERD

> 테이블 구조도

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2ee39848-40ce-4277-b5dc-c6816f970198/Untitled.png)
